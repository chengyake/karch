import numpy as np
from PIL import Image, ImageFilter

color_table=[
    (0x00, 0x00, 0x00), 
    (0x66, 0x66, 0x66),
    (0x80, 0x8A, 0x87),
    (0x80, 0x80, 0x69),
    (0xE6, 0xE6, 0xE6),
    (0xF5, 0xF5, 0xF5),
    (0xFC, 0xE6, 0xC9),
    (0xFF, 0x00, 0x00),
    (0xE3, 0x17, 0x0D),
    (0x9C, 0x66, 0x1F),
    (0xFF, 0x7F, 0x50),
    (0xFF, 0x63, 0x47),
    (0xFF, 0xC0, 0xCB),
    (0xB0, 0x17, 0x1F),
    (0xFF, 0x00, 0xFF),
    (0x99, 0x00, 0x33),
    (0x00, 0xFF, 0x00),
    (0x00, 0xFF, 0xFF),
    (0x7F, 0xFF, 0x00),
    (0x40, 0xE0, 0xD0),
    (0x08, 0x2E, 0x54),
    (0x22, 0x8B, 0x22),
    (0x6B, 0x8E, 0x23),
    (0x00, 0x00, 0xFF),
    (0x03, 0xA8, 0x9E),
    (0x19, 0x19, 0x70),
    (0x00, 0xC7, 0x8C),
    (0xFF, 0xFF, 0xFF),
    (0xF0, 0xFF, 0xFF),
    (0xCC, 0xCC, 0xCC),
    (0xFA, 0xFF, 0xF0),
    (0xFA, 0xF0, 0xE6),
    (0xFF, 0xFF, 0xCD),
    (0xFF, 0xF5, 0xEE),
    (0xFF, 0xFF, 0x00),
    (0xFF, 0x99, 0x12),
    (0xE3, 0xCF, 0x57),
    (0xFF, 0xD7, 0x00),
    (0xFF, 0x7D, 0x40),
    (0xFF, 0xE3, 0x84),
    (0xFF, 0x80, 0x00),
    (0xED, 0x91, 0x21),
    (0x8B, 0x86, 0x4E),
    (0x80, 0x2A, 0x2A),
    (0xC7, 0x61, 0x14),
    (0xF4, 0xA4, 0x60),
    (0xD2, 0xB4, 0x8C),
    (0xBC, 0x8F, 0x8F),
    (0xA0, 0x52, 0x2D),
    (0xC7, 0x61, 0x14),
    (0xA0, 0x20, 0xF0),
    (0xDA, 0x70, 0xD6),
    (0x8A, 0x2B, 0xE2),
    (0x99, 0x33, 0xFA)]



class MyGaussianBlur(ImageFilter.Filter):
    name = "GaussianBlur"
    def __init__(self, radius=2, bounds=None):
        self.radius = radius
        self.bounds = bounds
        def filter(self, image):
            if self.bounds:
                clips = image.crop(self.bounds).gaussian_blur(self.radius)
                image.paste(clips, self.bounds)
                return image
            else:
                return image.gaussian_blur(self.radius)




def CalcPixelBelong(rp,gp,bp):
    r0=255
    g0=255
    b0=255

    dis0=pow(255,2)*3
    for r,g,b in color_table:
        disp=pow(rp-r,2)+pow(gp-g,2)+pow(bp-b,2)
        #disp=abs(rp-r)+abs(gp-g)+abs(bp-b)
        if disp < dis0:
            dis0=disp
            r0=r
            g0=g
            b0=b
    return r0,g0,b0


im = Image.open("./cat.jpg")
im=im.filter(ImageFilter.GaussianBlur(radius=2))  
w,h=im.size
for i in range(w):
    for j in range(h):
        r,g,b=im.getpixel((i,j))
        r,g,b=CalcPixelBelong(r,g,b)
        im.putpixel((i,j), (r,g,b))




im.show()





